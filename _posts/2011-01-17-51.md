---
layout: post
title: 
date: 2011-01-17 08:27
author: admin
comments: true
categories: [Uncategorized]
---
<p><strong>Memory Management in the Glow engine</strong></p> <p>Memory management is very important thing in a console world. We can forget  about it on a PC (at least for several hours without leaks, but consoles are  restricted, so we should consider that after some time, allocation of memory  will return NULL (or exception, depending on compiler). Also fragmentation  is serious problem after allocation of many small objects. So with the plans to  move on mobile devices, we decided to develop system for memory management.</p> <p>New memory manager is implemented for Glow engine. Separate optimized  singlethreaded heaps with pools for small objects for every module of the engine  (physics, ai, navigation, sounds etc) are added instead of the single common C++  heap.</p> <p>Special heap for transferring messages between modules, memory leak  debugging, shared pointers (boost c++ library) for memory arrays.</p> <p>Allocator for STL containers was implemented, so every memory allocation in  the specific module goes from the module heap. STL containers and strings are  evil force of a memory fragmentation, so process for removing every STL  container from code is started.  Some vectors are replaced by special Stack  vector container, based on boost::array with restricted dynamic grow. Also major  part of constant std::string was replaced with const char* equivalent (with  memory allocated from constant string pool) and "copy on create if exists"  usage.</p> <p>Memory debugger UI, with rendering of memory fragmentation, information about  allocated blocks - count, amount, overhead.</p><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_LfYx03jjmdk/TTP99AX26sI/AAAAAAAABEk/SSLREq0nZ-o/s1600/editor_memory_detailed.jpg"><img style="cursor:pointer; cursor:hand;width: 320px; height: 194px;" src="http://4.bp.blogspot.com/_LfYx03jjmdk/TTP99AX26sI/AAAAAAAABEk/SSLREq0nZ-o/s320/editor_memory_detailed.jpg" border="0" alt="" id="BLOGGER_PHOTO_ID_5563069189246610114" /></a><br /><br />Remaining part for the memory manager implementation - garbage collector for Geometry.<br /><br />January release date was very optimistic, so we moved release of alpha version to Spring, 2011. Major parts are ready, but there are many small task to polish editor and engine.
